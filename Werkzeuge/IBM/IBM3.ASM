        PAGE 80,132
        .SALL
;=====================================================================
; MS-Macro-Assembler V1.10 / Wang PC
; (c) Ulrich Berntien .06.1991
;     letzte Änderung .06.1991
;=====================================================================
; IBM Zeichensatz installieren
; der Zeichensatz stammt aus dem
;   Microsoft System Journal März/April 1991
; mit der Hilfe der Programme
;   FONT2ASM.ASM  und  FONG.ASM
;=====================================================================
; linken mit IBM1.ASM, IBM2.ASM
;=====================================================================

INCLUDE ibmi.asm

;=====================================================================
data    SEGMENT WORD PUBLIC 'data'

outport DW ?
status  DD ?

font    EQU THIS WORD

DW 0022H  ; 01H
  DW 000H,000H,1FEH,303H,3CFH,303H,34BH,37BH,303H,1FEH,000H,000H
DW 0042H  ; 02H
  DW 000H,000H,1FEH,3FFH,333H,3FFH,3B7H,387H,3FFH,1FEH,000H,000H
DW 0062H  ; 03H
  DW 000H,000H,0D8H,1FCH,1FCH,1FCH,0F8H,070H,020H,000H,000H,000H
DW 0082H  ; 04H
  DW 000H,000H,020H,070H,0F8H,1FCH,0F8H,070H,020H,000H,000H,000H
DW 00A2H  ; 05H
  DW 000H,000H,078H,0FCH,078H,0FCH,1FEH,0FCH,078H,0FCH,000H,000H
DW 00C2H  ; 06H
  DW 000H,000H,020H,020H,070H,0F8H,1FCH,0F8H,070H,0F8H,000H,000H
DW 00E2H  ; 07H
  DW 000H,000H,000H,000H,030H,078H,078H,030H,000H,000H,000H,000H
DW 0102H  ; 08H
  DW 000H,000H,1FEH,1FEH,1CEH,186H,186H,1CEH,1FEH,1FEH,000H,000H
DW 0122H  ; 09H
  DW 000H,000H,000H,078H,0CCH,084H,084H,0CCH,078H,000H,000H,000H
DW 0142H  ; 0AH
  DW 000H,000H,1FEH,186H,132H,17AH,17AH,132H,186H,1FEH,000H,000H
DW 0162H  ; 0BH
  DW 000H,000H,01EH,00EH,01EH,0FAH,198H,198H,198H,0F0H,000H,000H
DW 0182H  ; 0CH
  DW 000H,000H,078H,0CCH,0CCH,0CCH,078H,030H,0FCH,030H,000H,000H
DW 01A2H  ; 0DH
  DW 000H,000H,07EH,066H,07EH,060H,060H,0E0H,1E0H,1C0H,000H,000H
DW 01C2H  ; 0EH
  DW 000H,000H,0FEH,0C6H,0FEH,0C6H,0C6H,0CEH,1CCH,180H,000H,000H
DW 01E2H  ; 0FH
  DW 000H,000H,132H,0B4H,078H,1CEH,1CEH,078H,0B4H,132H,000H,000H
DW 0202H  ; 10H
  DW 000H,000H,100H,1C0H,1F0H,1FCH,1F0H,1C0H,100H,000H,000H,000H
DW 0222H  ; 11H
  DW 000H,000H,004H,01CH,07CH,1FCH,07CH,01CH,004H,000H,000H,000H
DW 0242H  ; 12H
  DW 000H,000H,030H,078H,0FCH,030H,030H,0FCH,078H,030H,000H,000H
DW 0262H  ; 13H
  DW 000H,000H,0CCH,0CCH,0CCH,0CCH,0CCH,000H,0CCH,000H,000H,000H
DW 0282H  ; 14H
  DW 000H,000H,0FEH,1B6H,1B6H,0F6H,036H,036H,036H,000H,000H,000H
DW 02A2H  ; 15H
  DW 000H,000H,07CH,0C6H,070H,0D8H,0D8H,070H,198H,0F0H,000H,000H
DW 02C2H  ; 16H
  DW 000H,000H,000H,000H,000H,000H,0FCH,0FCH,0FCH,000H,000H,000H
DW 02E2H  ; 17H
  DW 000H,000H,030H,078H,0FCH,030H,0FCH,078H,030H,1FEH,000H,000H
DW 0302H  ; 18H
  DW 000H,000H,030H,078H,0FCH,030H,030H,030H,030H,000H,000H,000H
DW 0322H  ; 19H
  DW 000H,000H,030H,030H,030H,030H,0FCH,078H,030H,000H,000H,000H
DW 0342H  ; 1AH
  DW 000H,000H,000H,030H,018H,1FCH,018H,030H,000H,000H,000H,000H
DW 0362H  ; 1BH
  DW 000H,000H,000H,060H,0C0H,1FCH,0C0H,060H,000H,000H,000H,000H
DW 0382H  ; 1CH
  DW 000H,000H,000H,000H,180H,180H,180H,1FCH,000H,000H,000H,000H
DW 03A2H  ; 1DH
  DW 000H,000H,000H,048H,0CCH,1FEH,0CCH,048H,000H,000H,000H,000H
DW 03C2H  ; 1EH
  DW 000H,000H,000H,030H,078H,0FCH,1FEH,1FEH,000H,000H,000H,000H
DW 03E2H  ; 1FH
  DW 000H,000H,000H,1FEH,1FEH,0FCH,078H,030H,000H,000H,000H,000H
DW 1022H  ; 81H
  DW 000H,000H,000H,0CCH,000H,0CCH,0CCH,0CCH,07EH,000H,000H,000H
DW 1042H  ; 82H
  DW 000H,00CH,018H,000H,078H,0CCH,0FCH,0C0H,078H,000H,000H,000H
DW 1062H  ; 83H
  DW 000H,000H,0FCH,186H,078H,00CH,07CH,0CCH,07EH,000H,000H,000H
DW 1082H  ; 84H
  DW 000H,000H,0CCH,000H,078H,00CH,07CH,0CCH,07EH,000H,000H,000H
DW 10A2H  ; 85H
  DW 000H,0C0H,060H,000H,078H,00CH,07CH,0CCH,07EH,000H,000H,000H
DW 10C2H  ; 86H
  DW 000H,018H,030H,000H,078H,00CH,07CH,0CCH,07EH,000H,000H,000H
DW 10E2H  ; 87H
  DW 000H,000H,000H,000H,078H,0C0H,0C0H,078H,00CH,038H,000H,000H
DW 1102H  ; 88H
  DW 000H,0FCH,186H,000H,078H,0CCH,0FCH,0C0H,078H,000H,000H,000H
DW 1122H  ; 89H
  DW 000H,000H,0CCH,000H,078H,0CCH,0FCH,0C0H,078H,000H,000H,000H
DW 1142H  ; 8AH
  DW 000H,0C0H,060H,000H,078H,0CCH,0FCH,0C0H,078H,000H,000H,000H
DW 1162H  ; 8BH
  DW 000H,000H,0CCH,000H,070H,030H,030H,030H,078H,000H,000H,000H
DW 1182H  ; 8CH
  DW 000H,000H,0F8H,18CH,070H,030H,030H,030H,078H,000H,000H,000H
DW 11A2H  ; 8DH
  DW 000H,0C0H,060H,000H,070H,030H,030H,030H,078H,000H,000H,000H
DW 11C2H  ; 8EH
  DW 000H,000H,0C6H,038H,06CH,0C6H,0FEH,0C6H,0C6H,000H,000H,000H
DW 11E2H  ; 8FH
  DW 000H,000H,030H,030H,000H,078H,0CCH,0FCH,0CCH,000H,000H,000H
DW 1202H  ; 90H
  DW 000H,000H,01CH,000H,0FCH,060H,078H,060H,0FCH,000H,000H,000H
DW 1222H  ; 91H
  DW 000H,000H,000H,000H,0FEH,018H,0FEH,198H,0FEH,000H,000H,000H
DW 1242H  ; 92H
  DW 000H,000H,03EH,06CH,0CCH,0FEH,0CCH,0CCH,0CEH,000H,000H,000H
DW 1262H  ; 93H
  DW 000H,000H,070H,0CCH,000H,078H,0CCH,0CCH,078H,000H,000H,000H
DW 1282H  ; 94H
  DW 000H,000H,000H,0CCH,000H,078H,0CCH,0CCH,078H,000H,000H,000H
DW 12A2H  ; 95H
  DW 000H,000H,0C0H,060H,000H,078H,0CCH,0CCH,078H,000H,000H,000H
DW 12C2H  ; 96H
  DW 000H,000H,078H,0CCH,000H,0CCH,0CCH,0CCH,07EH,000H,000H,000H
DW 12E2H  ; 97H
  DW 000H,000H,0C0H,060H,000H,0CCH,0CCH,0CCH,07EH,000H,000H,000H
DW 1302H  ; 98H
  DW 000H,000H,000H,0CCH,000H,0CCH,0CCH,07CH,00CH,0F8H,000H,000H
DW 1322H  ; 99H
  DW 000H,000H,186H,030H,078H,0CCH,0CCH,078H,030H,000H,000H,000H
DW 1342H  ; 9AH
  DW 000H,000H,0CCH,000H,0CCH,0CCH,0CCH,0CCH,078H,000H,000H,000H
DW 1362H  ; 9BH
  DW 000H,000H,030H,030H,0FCH,180H,180H,0FCH,030H,030H,000H,000H
DW 1382H  ; 9CH
  DW 000H,000H,038H,06CH,064H,0F0H,060H,0E6H,0FCH,000H,000H,000H
DW 13A2H  ; 9DH
  DW 000H,000H,0CCH,0CCH,078H,030H,0FCH,030H,0FCH,030H,030H,000H
DW 13C2H  ; 9EH
  DW 000H,000H,1F0H,198H,198H,1F4H,18CH,19EH,18CH,18EH,000H,000H
DW 13E2H  ; 9FH
  DW 000H,000H,01CH,036H,030H,078H,030H,030H,1B0H,0E0H,000H,000H
DW 1402H  ; A0H
  DW 000H,00CH,018H,000H,078H,00CH,07CH,0CCH,07EH,000H,000H,000H
DW 1422H  ; A1H
  DW 000H,018H,030H,000H,070H,030H,030H,030H,078H,000H,000H,000H
DW 1442H  ; A2H
  DW 000H,000H,00CH,018H,000H,078H,0CCH,0CCH,078H,000H,000H,000H
DW 1462H  ; A3H
  DW 000H,000H,00CH,018H,000H,0CCH,0CCH,0CCH,07EH,000H,000H,000H
DW 1482H  ; A4H
  DW 000H,000H,06CH,0D8H,000H,0F8H,0CCH,0CCH,0CCH,000H,000H,000H
DW 14A2H  ; A5H
  DW 000H,06CH,0D8H,000H,0CCH,0ECH,0FCH,0DCH,0CCH,000H,000H,000H
DW 14C2H  ; A6H
  DW 000H,000H,078H,0D8H,0D8H,07CH,000H,0FCH,000H,000H,000H,000H
DW 14E2H  ; A7H
  DW 000H,000H,070H,0D8H,0D8H,070H,000H,0F8H,000H,000H,000H,000H
DW 1502H  ; A8H
  DW 000H,000H,030H,000H,030H,060H,0C0H,0CCH,078H,000H,000H,000H
DW 1522H  ; A9H
  DW 000H,000H,000H,000H,000H,0FFH,0C0H,0C0H,000H,000H,000H,000H
DW 1542H  ; AAH
  DW 000H,000H,000H,000H,000H,3FCH,00CH,00CH,000H,000H,000H,000H
DW 1562H  ; ABH
  DW 000H,000H,186H,18CH,198H,1BCH,066H,0CCH,198H,01EH,000H,000H
DW 1582H  ; ACH
  DW 000H,000H,186H,18CH,198H,036H,06EH,0DEH,19EH,006H,006H,000H
DW 15A2H  ; ADH
  DW 000H,000H,030H,000H,030H,030H,030H,030H,030H,030H,000H,000H
DW 15C2H  ; AEH
  DW 000H,000H,000H,066H,0CCH,198H,0CCH,066H,000H,000H,000H,000H
DW 15E2H  ; AFH
  DW 000H,000H,000H,198H,0CCH,066H,0CCH,198H,000H,000H,000H,000H
DW 1602H  ; B0H
  DW 000H,318H,318H,000H,000H,18CH,18CH,000H,000H,0C6H,0C6H,000H
DW 1622H  ; B1H
  DW 39CH,39CH,000H,0E7H,0E7H,000H,3CEH,3CEH,000H,0E7H,0E7H,000H
DW 1642H  ; B2H
  DW 332H,0CCH,332H,0CCH,332H,0CCH,332H,0CCH,332H,0CCH,332H,0CCH
DW 1662H  ; B3H
  DW 030H,030H,030H,030H,030H,030H,030H,030H,030H,030H,030H,030H
DW 1682H  ; B4H
  DW 030H,030H,030H,030H,030H,030H,3F0H,030H,030H,030H,030H,030H
DW 16A2H  ; B5H
  DW 030H,030H,030H,030H,3F0H,030H,3F0H,030H,030H,030H,030H,030H
DW 16C2H  ; B6H
  DW 0CCH,0CCH,0CCH,0CCH,0CCH,0CCH,3CCH,0CCH,0CCH,0CCH,0CCH,0CCH
DW 16E2H  ; B7H
  DW 000H,000H,000H,000H,000H,000H,3FCH,0CCH,0CCH,0CCH,0CCH,0CCH
DW 1702H  ; B8H
  DW 000H,000H,000H,000H,3F0H,030H,3F0H,030H,030H,030H,030H,030H
DW 1722H  ; B9H
  DW 0CCH,0CCH,0CCH,0CCH,3CCH,00CH,3CCH,0CCH,0CCH,0CCH,0CCH,0CCH
DW 1742H  ; BAH
  DW 0CCH,0CCH,0CCH,0CCH,0CCH,0CCH,0CCH,0CCH,0CCH,0CCH,0CCH,0CCH
DW 1762H  ; BBH
  DW 000H,000H,000H,000H,3FCH,00CH,3CCH,0CCH,0CCH,0CCH,0CCH,0CCH
DW 1782H  ; BCH
  DW 0CCH,0CCH,0CCH,0CCH,3CCH,00CH,3FCH,000H,000H,000H,000H,000H
DW 17A2H  ; BDH
  DW 0CCH,0CCH,0CCH,0CCH,0CCH,0CCH,3FCH,000H,000H,000H,000H,000H
DW 17C2H  ; BEH
  DW 030H,030H,030H,030H,3F0H,030H,3F0H,000H,000H,000H,000H,000H
DW 17E2H  ; BFH
  DW 000H,000H,000H,000H,000H,000H,3F0H,030H,030H,030H,030H,030H
DW 1802H  ; C0H
  DW 030H,030H,030H,030H,030H,030H,03FH,000H,000H,000H,000H,000H
DW 1822H  ; C1H
  DW 030H,030H,030H,030H,030H,030H,3FFH,000H,000H,000H,000H,000H
DW 1842H  ; C2H
  DW 000H,000H,000H,000H,000H,000H,3FFH,030H,030H,030H,030H,030H
DW 1862H  ; C3H
  DW 030H,030H,030H,030H,030H,030H,03FH,030H,030H,030H,030H,030H
DW 1882H  ; C4H
  DW 000H,000H,000H,000H,000H,000H,3FFH,000H,000H,000H,000H,000H
DW 18A2H  ; C5H
  DW 030H,030H,030H,030H,030H,030H,3FFH,030H,030H,030H,030H,030H
DW 18C2H  ; C6H
  DW 030H,030H,030H,030H,03FH,030H,03FH,030H,030H,030H,030H,030H
DW 18E2H  ; C7H
  DW 0CCH,0CCH,0CCH,0CCH,0CCH,0CCH,0CFH,0CCH,0CCH,0CCH,000H,000H
DW 1902H  ; C8H
  DW 0CCH,0CCH,0CCH,0CCH,0CFH,0C0H,0FFH,000H,000H,000H,000H,000H
DW 1922H  ; C9H
  DW 000H,000H,000H,000H,0FFH,0C0H,0CFH,0CCH,0CCH,0CCH,0CCH,0CCH
DW 1942H  ; CAH
  DW 0CCH,0CCH,0CCH,0CCH,3CFH,000H,3FFH,000H,000H,000H,000H,000H
DW 1962H  ; CBH
  DW 000H,000H,000H,000H,3FFH,000H,3CFH,0CCH,0CCH,0CCH,0CCH,0CCH
DW 1982H  ; CCH
  DW 0CCH,0CCH,0CCH,0CCH,0CFH,0C0H,0CFH,0CCH,0CCH,0CCH,0CCH,0CCH
DW 19A2H  ; CDH
  DW 000H,000H,000H,000H,3FFH,000H,3FFH,000H,000H,000H,000H,000H
DW 19C2H  ; CEH
  DW 0CCH,0CCH,0CCH,0CCH,3CFH,000H,3CFH,0CCH,0CCH,0CCH,0CCH,0CCH
DW 19E2H  ; CFH
  DW 030H,030H,030H,030H,3FFH,000H,3FFH,000H,000H,000H,000H,000H
DW 1A02H  ; D0H
  DW 0CCH,0CCH,0CCH,0CCH,0CCH,0CCH,3FFH,000H,000H,000H,000H,000H
DW 1A22H  ; D1H
  DW 000H,000H,000H,000H,3FFH,000H,3FFH,030H,030H,030H,030H,030H
DW 1A42H  ; D2H
  DW 000H,000H,000H,000H,000H,000H,3FFH,0CCH,0CCH,0CCH,0CCH,0CCH
DW 1A62H  ; D3H
  DW 0CCH,0CCH,0CCH,0CCH,0CCH,0CCH,0FFH,000H,000H,000H,000H,000H
DW 1A82H  ; D4H
  DW 030H,030H,030H,030H,03FH,030H,03FH,000H,000H,000H,000H,000H
DW 1AA2H  ; D5H
  DW 000H,000H,000H,000H,03FH,030H,03FH,030H,030H,030H,030H,030H
DW 1AC2H  ; D6H
  DW 000H,000H,000H,000H,000H,000H,0FFH,0CCH,0CCH,0CCH,0CCH,0CCH
DW 1AE2H  ; D7H
  DW 0CCH,0CCH,0CCH,0CCH,0CCH,0CCH,3FFH,0CCH,0CCH,0CCH,0CCH,0CCH
DW 1B02H  ; D8H
  DW 030H,030H,030H,030H,3FFH,030H,3FFH,030H,030H,030H,030H,030H
DW 1B22H  ; D9H
  DW 030H,030H,030H,030H,030H,030H,3F0H,000H,000H,000H,000H,000H
DW 1B42H  ; DAH
  DW 000H,000H,000H,000H,000H,000H,03FH,030H,030H,030H,030H,030H
DW 1B62H  ; DBH
  DW 3FFH,3FFH,3FFH,3FFH,3FFH,3FFH,3FFH,3FFH,3FFH,3FFH,3FFH,3FFH
DW 1B82H  ; DCH
  DW 000H,000H,000H,000H,000H,000H,3FFH,3FFH,3FFH,3FFH,3FFH,3FFH
DW 1BA2H  ; DDH
  DW 3E0H,3E0H,3E0H,3E0H,3E0H,3E0H,3E0H,3E0H,3E0H,3E0H,3E0H,3E0H
DW 1BC2H  ; DEH
  DW 01FH,01FH,01FH,01FH,01FH,01FH,01FH,01FH,01FH,01FH,01FH,01FH
DW 1BE2H  ; DFH
  DW 3FFH,3FFH,3FFH,3FFH,3FFH,3FFH,000H,000H,000H,000H,000H,000H
DW 1C02H  ; E0H
  DW 000H,000H,000H,000H,0F6H,19CH,198H,19CH,0F6H,000H,000H,000H
DW 1C22H  ; E1H
  DW 000H,000H,000H,078H,0CCH,0F8H,0CCH,0F8H,0C0H,0C0H,000H,000H
DW 1C42H  ; E2H
  DW 000H,000H,000H,0FCH,0CCH,0C0H,0C0H,0C0H,0C0H,000H,000H,000H
DW 1C62H  ; E3H
  DW 000H,000H,000H,1FEH,0CCH,0CCH,0CCH,0CCH,0CCH,000H,000H,000H
DW 1C82H  ; E4H
  DW 000H,000H,0FCH,0CCH,060H,030H,060H,0CCH,0FCH,000H,000H,000H
DW 1CA2H  ; E5H
  DW 000H,000H,000H,000H,07EH,0D8H,0D8H,0D8H,070H,000H,000H,000H
DW 1CC2H  ; E6H
  DW 000H,000H,000H,066H,066H,066H,066H,07CH,060H,0C0H,000H,000H
DW 1CE2H  ; E7H
  DW 000H,000H,000H,076H,0DCH,018H,018H,018H,018H,000H,000H,000H
DW 1D02H  ; E8H
  DW 000H,000H,0FCH,030H,078H,0CCH,0CCH,078H,030H,0FCH,000H,000H
DW 1D22H  ; E9H
  DW 000H,000H,078H,0CCH,186H,1FEH,186H,0CCH,078H,000H,000H,000H
DW 1D42H  ; EAH
  DW 000H,000H,078H,0CCH,186H,186H,0CCH,0CCH,1CEH,000H,000H,000H
DW 1D62H  ; EBH
  DW 000H,000H,01CH,030H,018H,07CH,0CCH,0CCH,078H,000H,000H,000H
DW 1D82H  ; ECH
  DW 000H,000H,000H,000H,0FCH,1B6H,1B6H,0FCH,000H,000H,000H,000H
DW 1DA2H  ; EDH
  DW 000H,000H,00CH,018H,0FCH,1B6H,1B6H,0FCH,0C0H,180H,000H,000H
DW 1DC2H  ; EEH
  DW 000H,000H,078H,0C0H,180H,1F8H,180H,0C0H,078H,000H,000H,000H
DW 1DE2H  ; EFH
  DW 000H,000H,078H,0CCH,0CCH,0CCH,0CCH,0CCH,0CCH,000H,000H,000H
DW 1E02H  ; F0H
  DW 000H,000H,000H,0FCH,000H,0FCH,000H,0FCH,000H,000H,000H,000H
DW 1E22H  ; F1H
  DW 000H,000H,030H,030H,0FCH,030H,030H,000H,0FCH,000H,000H,000H
DW 1E42H  ; F2H
  DW 000H,000H,060H,030H,018H,030H,060H,000H,0FCH,000H,000H,000H
DW 1E62H  ; F3H
  DW 000H,000H,018H,030H,060H,030H,018H,000H,0FCH,000H,000H,000H
DW 1E82H  ; F4H
  DW 000H,000H,01CH,036H,036H,030H,030H,030H,030H,030H,030H,030H
DW 1EA2H  ; F5H
  DW 030H,030H,030H,030H,030H,030H,030H,1B0H,1B0H,0E0H,000H,000H
DW 1EC2H  ; F6H
  DW 000H,000H,000H,030H,000H,0FCH,000H,030H,000H,000H,000H,000H
DW 1EE2H  ; F7H
  DW 000H,000H,000H,0ECH,1B8H,000H,0ECH,1B8H,000H,000H,000H,000H
DW 1F02H  ; F8H
  DW 000H,000H,070H,0D8H,0D8H,070H,000H,000H,000H,000H,000H,000H
DW 1F22H  ; F9H
  DW 000H,000H,000H,000H,000H,030H,030H,000H,000H,000H,000H,000H
DW 1F42H  ; FAH
  DW 000H,000H,000H,000H,000H,000H,030H,000H,000H,000H,000H,000H
DW 1F62H  ; FBH
  DW 000H,01FH,018H,018H,018H,018H,1D8H,0D8H,078H,038H,000H,000H
DW 1F82H  ; FCH
  DW 000H,000H,0F0H,0D8H,0D8H,0D8H,0D8H,000H,000H,000H,000H,000H
DW 1FA2H  ; FDH
  DW 000H,000H,0E0H,030H,060H,0C0H,0F0H,000H,000H,000H,000H,000H
DW 1FC2H  ; FEH
  DW 000H,000H,000H,000H,078H,078H,078H,078H,000H,000H,000H,000H
DW -1

data    ENDS

;=====================================================================
code    SEGMENT WORD PUBLIC 'code'
ASSUME  ds : data, cs : code

EXTRN doserr : NEAR
EXTRN bioserr: NEAR

; Word in Bildschirm Zeichengenerator schreiben
; ARGS: DI Adresse
;       AX das Word
; RETS: -
; REGS: außer AX,BX,DX,ES alle erhalten
;-------------------------------------------------------------------02
put     PROC NEAR
        pushing <cx>
        mov   cx,ax                           ;zeichen merken
        mov   dx,outport                      ;port zur monitor karte
        les   bx,status                       ;ads des 1.statusbytes
        mov   al,es:[bx]                      ;status lesen
        and   al,0CH
        or    al,01H                          ;signal für karte erzeugen
        mov   bx,0F200H                       ;segment des zeichengen.
        mov   es,bx
        out   dx,al                           ;signal an die karte
        mov   es:[di],cx                      ;word schreiben
        poping <cx>
        ret
put     ENDP

; Initialisieren den Zugriff auf den Zeichengenerator
; ARGS: DS auf data
; RETS: -
; REGS: außer ES alle erhalten
;-------------------------------------------------------------------01
init    PROC NEAR
        pushing <ax,bx,dx>
        mov   al,01                           ;zeiger auf sys.config table
        bios
        mov   bx,es:[bx+0AH]                  ;adr des sib
        mov   dh,es:[bx+13H]                  ;high byte des ports
        mov   dl,10H                          ;low byte des ports
        mov   outport,dx                      ;port numer speichern
        add   bx,8                            ;bx auf status byte
        mov   WORD PTR status,bx              ;die adr speichern
        mov   WORD PTR status+2,es            ;das segment speichern
        poping <dx,bx,ax>
        ret
init    ENDP

PUBLIC setibmfont

; IBM-Zeichensatz installieren
; ARGS: -
; RETS: -
; REGS: alle erhalten
;-------------------------------------------------------------------00
setibmfont PROC NEAR
        pushing <ax,bx,cx,dx,si,di,ds,es>
        mov   ax,SEG data
        mov   ds,ax                           ;ds auf data
        call  init
        lea   si,font                         ;mit si die tabelle durchgehen
        cld
        jmp   SHORT l0000                     ;in die schleife springen

l0001:  mov   cx,12                           ;12 words in einem zeichen
        mov   di,ax                           ;dorthin in den zeichengenerator
l0002:  lodsw
        call  put                             ;eine zeile setzen
        inc   di
        inc   di                              ;di auf näcshte zeile des zeichens
        loop  l0002

l0000:  lodsw                                 ;nächste adresse
        cmp   ax,-1
        jne   l0001                           ;nicht ende der font tabelle

        poping <es,ds,di,si,dx,cx,bx,ax>
        ret
setibmfont ENDP

code    ENDS
        END
